---
title : 'source'
output : html_document
---

# source.Rmd
#
# William John Zywiec
# The George Washington University

```{r, include = FALSE}

# initialize environment
if (!is.null(dev.list())) dev.off()
rm(list = ls())
cat('\014')

```

```{r, setup, include = FALSE, message = FALSE, warning = FALSE}

# set variables
code.dir <- 'E:/Dropbox/GWU/R/code'
main.dir <- 'F:/main'

```

```{r, message = FALSE, warning = FALSE}

# load function
source(paste0(code.dir, '/tabulate.R'))

# tabulate data
data.set <- Tabulate(code.dir, main.dir)

```

```{r, message = FALSE, warning = FALSE}

# set variables
batch.size <- 8192
ensemble.size <- 20
epochs <- 300
layers <- '8192-256-256-256-256-16'
loss <- 'sse'
lr <- 0.00075
val.split <- 0.1

# load function
source(paste0(code.dir, '/nn.R'))

# build ensemble model
ensemble.model <- NN(data.set, batch.size, ensemble.size, epochs, layers, loss, lr, val.split, code.dir, main.dir)

```

```{r, message = FALSE, warning = FALSE}

# set variables
dist <- 'gamma'
risk.pool <- 100
sample.size <- 1e+07

# load functions
source(paste0(code.dir, '/bn.R'))
source(paste0(code.dir, '/risk.R'))

# build Bayesian network
bn <- BN(dist, main.dir)

# formulate risk estimate
risk <- Risk(bn, data.set, ensemble.model, ensemble.size, sample.size, code.dir, main.dir)

```
